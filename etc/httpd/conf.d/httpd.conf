#
# Configuration for a web application that uses:
#
#   - mod_ssl
#   - mod_wsgi
#
# Features:
#
#   - Listens for SSL connections on port 8443.
#   - Configures all requests to go through the web application.
#

ServerName localhost
Listen 8443

## Minimize information sent about this server.

ServerSignature Off
ServerTokens ProductOnly
TraceEnable Off

## Redirect all non-SSL requests.

<VirtualHost *:80>
  Redirect permanent / https://localhost:8443/
</VirtualHost>

<VirtualHost *:8443>
  ServerName localhost
  ServerAdmin support@localhost

  ## Allow unrestricted access to the web space.

  <Location "/">
    Require all granted
    AuthType none
  </Location>

  ## Configure logging.

  ErrorLog "/var/log/httpd/local_default_ssl_error_ssl.log"
  LogLevel info
  CustomLog "/var/log/httpd/local_default_ssl_access_ssl.log" combined

  ## Configure SSL.

  SSLEngine on
  SSLCertificateFile "/etc/grid-security/hostcert.pem"
  SSLCertificateKeyFile "/etc/grid-security/hostkey.pem"
  SSLCertificateChainFile "/etc/grid-security/hostcert.pem"

  ## Configure WSGI.

  WSGIDaemonProcess WebApp display-name=WebApp processes=2 home=/srv
  WSGIProcessGroup WebApp
  WSGIScriptAlias / "/srv/wsgi.py"
</VirtualHost>
